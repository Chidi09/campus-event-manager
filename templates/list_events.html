{% extends "base.html" %}

{% block title %}Available Events{% endblock %}

{% block content %}
<div class="main-content-container">
    <h2>Available Events</h2>

    {% if events %}
        <div class="event-list-grid">
            {% for event in events %}
                <div class="event-card">
                    <h3>{{ event.name }}</h3>
                    <p class="event-meta"><strong>Date:</strong> {{ event.date.strftime('%A, %B %d, %Y at %I:%M %p') }}</p>
                    <p class="event-meta"><strong>Location:</strong> {{ event.location }}</p>
                    <p class="event-meta"><strong>Price:</strong>
                        {% if event.price == 0 %}
                            Free
                        {% else %}
                            ${{ "%.2f"|format(event.price) }}
                        {% endif %}
                    </p>
                    <p class="event-meta"><strong>Capacity:</strong>
                        {% if event.capacity is none %}
                            Unlimited
                        {% else %}
                            {{ event.capacity }}
                            {% set current_registrations = event.registrations|length %}
                            (Remaining: {{ event.capacity - current_registrations }})
                        {% endif %}
                    </p>
                    <p class="event-description">{{ event.description | truncate(150) }}</p>
                    <div class="event-actions">
                        <a href="{{ url_for('event_details', event_id=event.id) }}" class="button-link-styled">View Details</a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No events are currently scheduled.</p>
    {% endif %}

    <p style="margin-top: 20px;">
        <a href="{{ url_for('dashboard') }}" class="button-link-styled">Back to Dashboard</a>
    </p>
</div>
{% endblock %}

{% block extra_css %}
<style>
    .event-list-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        padding: 20px 0;
    }
    .event-card {
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    .event-card h3 {
        color: var(--primary-blue);
        margin-top: 0;
        margin-bottom: 10px;
        font-size: 1.5em;
    }
    .event-meta {
        font-size: 0.9em;
        color: var(--text-color-light);
        margin-bottom: 5px;
    }
    .event-description {
        font-size: 1em;
        color: var(--text-color);
        margin-top: 15px;
        margin-bottom: 20px;
        flex-grow: 1;
    }
    .event-actions {
        margin-top: auto;
        text-align: right;
    }
    .button-link-styled {
        display: inline-block;
        padding: 8px 15px;
        background-color: var(--primary-blue);
        color: white;
        border-radius: 5px;
        text-decoration: none;
        font-weight: bold;
        transition: background-color 0.3s ease;
    }
    .button-link-styled:hover {
        background-color: var(--primary-blue-dark);
    }
</style>
{% endblock %}
